<VirtualHost *:80>
    ServerName dopomogaplus.silencatech.com

    RewriteEngine On
    RewriteCond %{REQUEST_URI}  ^/socket.io            [NC]
    RewriteCond %{QUERY_STRING} transport=websocket    [NC]
    RewriteRule /(.*)           ws://127.0.0.1:8005/$1 [P,L]
    
    ProxyPass        /socket.io  http://127.0.0.1:8005/socket.io

    ProxyPassReverse /socket.io  http://127.0.0.1:8005/socket.io
    

</VirtualHost>


<VirtualHost *:443>
    ServerName dopomogaplus.silencatech.com


    SSLEngine			On
    SSLCertificateFile		/etc/letsencrypt/live/dopomogaplus.silencatech.com/cert.pem
    SSLCertificateChainFile	/etc/letsencrypt/live/dopomogaplus.silencatech.com/chain.pem
    SSLCertificateKeyFile	/etc/letsencrypt/live/dopomogaplus.silencatech.com/privkey.pem

    DocumentRoot /home/aster/crm/web
    Alias /var/spool/asterisk/monitor /var/spool/asterisk/monitor

    RewriteEngine On
    RewriteCond %{REQUEST_URI}  ^/socket.io            [NC]
    RewriteCond %{QUERY_STRING} transport=websocket    [NC]
    RewriteRule /(.*)           ws://127.0.0.1:8005/$1 [P,L]
    
	SSLProxyEngine On
	ProxyRequests Off
	ProxyPreserveHost On
	ProxyVia On

<Proxy *>
Require all granted
</Proxy>

    ProxyPass        /socket.io  http://127.0.0.1:8005/socket.io

    ProxyPassReverse /socket.io  http://127.0.0.1:8005/socket.io


    <Directory /var/spool/asterisk/monitor>
        Require all granted
    </Directory>
</VirtualHost>
