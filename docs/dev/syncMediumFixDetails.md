# Задача

# *Синхронизация БД контактов crm с БД medium

###          ****Подзадачи****
             ~~~~> Добавить роут для создания или апдейта контакта из Медиума:
                - [ ] - на стороне медиума срабатывает триггер, посылающий созданный объект на указанный роут
                - [ ] - приходит он в XML, формат не унифицирован
                - [ ] - уникальный идентификатор созданных Медиумом-объектов - поле "OID"
                - [ ] - идентификатор медиум-объекта мы сохраняем в таблицу контактов - колонка "medium_oid"
                - [ ] - полученный объект можно сохранить с помощью метода `ContactsController->actionSaveContacts($contact)`, где $contact - распапрсенный полученный объект
            - [ ] > Доработать соответствия полей полученных из Медиума к полям в CRM
            > Доработать заполнение полей формы редактирования контакта:
                - если контакт не имеет идентификатора медиума и/или статус не "Контакт", нужно пропустить отправку запроса на медиум и заполнять поля формы данными из БД CRM
                - если контакт имеет идентификатор и статус "Контакт", нужно отправить запрос с помощью метода Contact::getMediumObject($oid) и, при необходимости(отличии данных в crm) - проапдейтить изменения.
                - если контакт не имеет идентификатора и статус "Контакт", нужно отправить данный контакт в базу медиума с помощью Contact::postMediumObject($data);
     **Дополнения:
        >Для добавления или изменения контактов из СРМ в Медиум можно использовать следующие методы:
            - `Contact::updateMediumObject($oid, $data)` - апдейт или создание контакта
            - `Contact::postMediumObject($data)` - создание контакта
            - > Для формирования тела запросов используется метод:
                - `buildMediumRequestBody($data, $url)`
                - также, возможен вариант использования метода fields(), который возвращает объект с нужными полями в нужном формате;


     **PS:
         > Было добавлено много других методов, которые, возможно, не были еще задействованы, но возможно чем-то помогут.

---

[1]:Contact::MEDIUM_API_URL - ссылка, куда слать все запросы(!обязательно дополняется след параметрами[2])

---

[2]: Contact::MEDIUM_API_OBJECT = '/O:';//добавляется в конец [1], для получения данных по конкретному объекту(!дополняется oid нужного объекта)
Contact::MEDIUM_API_ITEM = '/I:';//--=--, получение данных по пачке объектов(!дополняется параметром 'PACK')

---

[1,2,ATTR].example :
$url = self::MEDIUM_API_URL . self::MEDIUM_API_OBJECT .$oid . '?method=save_object';
